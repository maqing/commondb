<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
	<title>编辑合同审核表</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<style media="all" type="text/css">@import "../css/all.css";</style>
	<link type="text/css" href="/app/css/ui-lightness/jquery-ui-1.7.2.custom.css" rel="stylesheet" />
	<link href="../_lib/uploadify/uploadify.css" type="text/css" rel="stylesheet" />
	<script src="../_lib/jquery-1.4.2.min.js" type="text/javascript"> </script>

	<script src="../_lib/jquery-ui-1.8.16.custom.min.js" type="text/javascript"> </script> 
	<!--   <script type="text/javascript" src='../_lib/jquery-ui-1.7.2.custom.min.js'></script> -->
	<script type="text/javascript" src='../_lib/timepicker.js'></script>

	<script type='text/javascript' src='../_lib/jquery.bgiframe.min.js'></script>
	<script type='text/javascript' src='../_lib/jquery.ajaxQueue.js'></script>
	<script type='text/javascript' src='../_lib/jquery.autocomplete.js'></script>
	<script type='text/javascript' src='../_lib/common.js'></script>
	<script type='text/javascript' src='../_lib/jquery.cookie.js'></script>

	<link rel="stylesheet" type="text/css" href="../_lib/jquery.autocomplete.css" />
	
	<script type="text/javascript" src="../_lib/uploadify/swfobject.js"></script>
	<script type="text/javascript" src="../_lib/uploadify/jquery.uploadify.v2.1.4.js"></script>
	
	
	<script type='text/javascript' >
	$(document).ready(function(){
		$("#合同审核表").addClass("active");
	    uploadMultiFile('${session.id}', calcFileDirectory());
    
		//创建tabs
		$("#tabs").tabs({
			ajaxOptions:{
				cache:false
			},
			cookie: {
				// store cookie for a day, without, it would be a session cookie
				expires: 1
			}			
		})
  	});
  
	</script>
		
</head>

<body>
  	#if(!$toRMetaId) 
<div id="main">
	<div id="header">
		<!-- 头部 -->
		#parse("/app/header.vm")
	</div>
	<div id="middle">
		<div id="center-column">
		<div id="top-bar" class="top-bar">
			<!-- 菜单 -->
			#parse("/app/newmenu.vm")
		</div>

			<div class="break-bar"></div>
	#end

		<form name="newEntity" id="newEntity" action="/app/contractsAudit/saveEntity.ac" method="post" enctype="multipart/form-data">
		<input type="hidden" name="metaId" value="${metaId}"/>
		<input type="hidden" name="entityId" value="${entityId}"/>
		<input type="hidden" name="toRMetaId" value="$!toRMetaId"/>
		<input type="hidden" name="toRMetaName" value="$!toRMetaName"/>
		<input type="hidden" name="toREntityId" value="$!toREntityId"/>
		<input type="hidden" name="toRLabel" value="$!toRLabel"/>
		<input type="hidden" name="update" value="1"/>
		<div class="table">
				<table cellspacing="0" cellpadding="0" class="listing form">
					<tbody>
					<tr>
						<th colspan="2" class="full">编辑合同审核表</th>
					</tr>
				#foreach(${f} in ${picFields})	
					<tr>
						<td width="100" class="first"><strong>$f.fieldId</strong></td>
						<td class="last">$f.inputHtml</td>
					</tr>
				#end	
				</table>
				
				<!-- 
				<table cellspacing="0" cellpadding="0" class="listing form">
				#foreach(${f} in ${descFields})	
					<tr>
						<td width="100" class="first"><strong>$f.fieldId</strong></td>
						<td class="last">$f.inputHtml</td>
					</tr>
				#end
				</table>
				 -->
				
				<table cellspacing="0" cellpadding="0" class="listing form">
					<tr>
						<td width="100"><strong>合同号</strong></td>
						<td class="last">$descFieldsMap.get("合同号")</td>
					</tr>
					<tr>
						<td width="100"><strong>项目名称</strong></td>
						<td class="last">$descFieldsMap.get("项目名称")</td>
					</tr>
					<tr>
						<td width="100"><strong>项目背景</strong></td>
						<td class="last">$descFieldsMap.get("项目背景")</td>
					</tr>
				</table>
				<table cellspacing="0" cellpadding="0" class="listing form">
					<tr>
						<td width="100"><strong>合同买方</strong></td>
						<td class="last">$descFieldsMap.get("合同买方")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("合同买方风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>合同最终用户</strong></td>
						<td class="last">$descFieldsMap.get("合同最终用户")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("合同最终用户风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>合同卖方</strong></td>
						<td class="last">$descFieldsMap.get("合同卖方")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("合同卖方风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>合同供货方</strong></td>
						<td class="last">$descFieldsMap.get("合同供货方")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("合同供货方风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>合同最终供货方</strong></td>
						<td class="last">$descFieldsMap.get("合同最终供货方")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("合同最终供货方风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>合同价格条款</strong></td>
						<td class="last">$descFieldsMap.get("合同价格条款")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("合同价格条款风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>交货期限条款</strong></td>
						<td class="last">$descFieldsMap.get("交货期限条款")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("交货期限条款风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>技术条款</strong></td>
						<td class="last">$descFieldsMap.get("技术条款")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("技术条款风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>供货内容条款</strong></td>
						<td class="last">$descFieldsMap.get("供货内容条款")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("供货内容条款风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>技术服务条款</strong></td>
						<td class="last">$descFieldsMap.get("技术服务条款")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("技术服务条款风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>售后服务条款</strong></td>
						<td class="last">$descFieldsMap.get("售后服务条款")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("售后服务条款风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>合同特别约定条款</strong></td>
						<td class="last">$descFieldsMap.get("合同特别约定条款")</td>
						<td width="100"><strong>风险评估</strong></td>
						<td class="last">$descFieldsMap.get("合同特别约定条款风险评估")</td>
					</tr>
					<tr>
						<td width="100"><strong>项目总体风险评估</strong></td>
						<td class="last"></td>
						<td width="100"><strong></strong></td>
						<td class="last">$descFieldsMap.get("项目总体风险评估")</td>
					</tr>
				</table>
				
				<!-- 分隔便于设定特殊页面版式 -->
				<table cellspacing="0" cellpadding="0" class="listing form">
				#foreach(${f} in ${hierFields})	
					<tr>
						<td width="100" class="first"><strong>$f.fieldId</strong></td>
						<td class="last">$f.inputHtml</td>
					</tr>
				#end	
				#foreach(${f} in ${charaFields})	

					<tr>
						<td width="100" class="first"><strong>$f.fieldId</strong></td>
						<td class="last">$f.inputHtml</td>
					</tr>
				#end	
						
					<tr>
					<td width="100" class="first"><strong>关联属性</strong></td>
					<td class="last">
					<div id="关联属性_display"> 
						#foreach(${f} in ${rEntityList})
						<a id=link_${f.meta2Id}_$f.entity2Id href='/app/tool/viewEntity.ac?metaId=${f.meta2Id}&entityId=$f.entity2Id' ><br/> $!f.label  </a>  
						<img id=del_icon_${f.meta2Id}_$f.entity2Id  onclick=removeEntity('${f.meta2Id}','$f.entity2Id','关联属性_display','relation') src='/app/img/del-icon.png'/> 
						#end
					</div>

					<input type="hidden" value="#foreach(${f} in ${rEntityList})
					#if($velocityCount == 1)
						${f.meta2Id}_${f.entity2Id}_${f.label}
					#else
						,${f.meta2Id}_${f.entity2Id}_${f.label}
					#end
					
					#end"
					 
					name="relation" id="relation"/>
					<img width="16" height="16" src="/app/img/add-icon.png" alt="find" onclick="selectEntity('通讯录','关联属性_display','relation')"/>
										</td>
					</tr>
					
					<tr>
						<td width="100" class="first"><strong>相关文件</strong></td>
						<td class="last">
						
							<div id="attachment_display"> 
						
							#foreach(${f} in ${rAttachmentList})
								<a id ="$f.id" href= "$f.attachmentPath" > $!f.attachmentName </a>  
										<img id=del_icon_${f.id}  onclick=removeAttachment('${f.id}','${f.attachmentPath}','attachNameList') src='/app/img/del-icon.png'/> 
							#end
							</div>
							<input type="hidden" value="#foreach(${f} in ${rAttachmentList})
								#if($velocityCount == 1)
									${f.attachmentPath}
									#else
									 *${f.attachmentPath}
								#end
								#end"
								 name="attachNameList" id="attachNameList" />
						
							<div id="fileQueue"></div>
						    <input id="fileUpload" name="fileUpload" type="file" />
						</td>
					</tr>
					
					<tr class="bg">
						<td class="first"><strong></strong></td>
					  <td class="last">
					  	<input onclick="submitUploadMultiFile()" type="button" value="提交"/>  
					  	#if(!$toRMetaId) 
					  		<input type="button" onclick="javascript:history.go(-1);" value="返回"/>
					  	#else
					  		<input type="button" onclick="window.close();" value="关闭"/>
					  	#end
					  </td>
					</tr>
					
				</tbody></table>
			<div id="tabs" class="ui-tabs">  
				<ul>  
					<li><a href="/app/contracts/trackEntity.ac?entityName=合同审核表&rEntityNames=合同库&entityId=$entityId&updateFlag=1&toRLabel=$toRLabel"><span>合同库</span></a></li>  
				</ul>  
			</div>
				
			</form>	
	        <p>&nbsp;</p>
		  </div>
		  
		</div>
		#if(!$toRMetaId) 
		<div id="right-column-tip">
			<strong class="h">帮助</strong>
			<div class="box">该页面是用来编辑合同审核表的，请在表格内输入各个字段的值，并点击“提交”按钮完成编辑。层级属性和关联属性请点击图标来选择</div>
			#parse("/app/tool/right.vm")
	  </div>
	</div>
	<!-- 页脚 -->
	<div id="footer">#parse("/app/footer.vm")</div>
</div>
	    #end

</body>

</html>
