<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
	<title>跟踪故障信息</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" type="text/css" media="screen" href="../_lib/timepicker/jquery-ui-timepicker-addon.css" />
	<script src="../_lib/timepicker/jquery-ui.js" type="text/javascript"> </script> 
	<script src="../_lib/timepicker/jquery-ui-slide.min.js" type="text/javascript"></script>
 	<script src='../_lib/timepicker/jquery-ui-timepicker-addon.js' type="text/javascript" ></script> 
</head>
<body>
<div id="errorMainRelation">
<form id="errorRelationForm">
	<!-- 为了关联页面增加分页时，将上一个页面传递来的参数保存再提交 -->
	<input type="hidden" name="entityName" value="${entityName}"/>
	<input type="hidden" name="rEntityNames" value="${rEntityNames}"/>
	<input type="hidden" name="entityId" value="${entityId}"/>
	<input type="hidden" name="updateFlag" value="${updateFlag}"/>						
		  

	#foreach(${rr} in ${favorMetaList})	

			<div style="overflow: auto; width: 700px;" class="table_tabs">
			<div style="width: 1200px;">
			<strong>故障开始时间从:</strong> <input type="text" name="timeErrorBegin" id="timeErrorBegin" value="$!timeErrorBegin" >
			<strong>到：</strong> <input type="text" name="timeErrorEnd" id="timeErrorEnd" value="$!timeErrorEnd" > 
			<input type="button" onclick="queryDeviceWorkData();" value="查询"/>
			&nbsp&nbsp&nbsp&nbsp
			#if($updateFlag == 1) 
			<input type="button" onclick="window.open('/app/deviceErrorData/genForm.ac?entityName='+ encodeURI('故障信息') +'&toRMetaId=${metaId}&toRMetaName=${entityName}&toREntityId=${entityId}&toRLabel=${entityId}' ,'remind',
		    'toolbar=no,scrollbars=yes,resizable=yes,top=100,left=100,width=744,height=700');" value="新增"/>
		    #end
				<table cellspacing="0" cellpadding="0" class="listing" style="table-layout:fixed; border:1px solid #9097A9;">
					<tbody>
					<tr>
					<th style="width:50px">操作</th>
				#foreach(${f} in ${rr.fieldsList})	
				
					<th style="
					#if($f.fieldId=='MSN号码')width:200px
					#elseif($f.fieldId=='e-mail')width:200px
					#elseif($f.fieldId=='地址')width:200px
					#elseif($f.fieldId!='地址')width:90px
					#end" 
					class=""><strong>$f.fieldId</strong></th>
				
				#end
					<th style="width:90px" onclick="reOrder('update_time')"><strong>更新时间</strong> </th>
					<th style="width:90px" class="last" onclick="reOrder('update_user')"><strong>更新人</strong> </th>
				
					</tr>

					<tr>
					#foreach($row in $rr.resList)
					<tr id="trentity_$row.get(3).getValue()">
					<td>
					<a href="#" onclick= "window.open('/app/deviceErrorData/viewEntity.ac?entityName='+ encodeURI('故障信息') +'&toRMetaId=${metaId}&toRMetaName=${entityName}&toREntityId=${entityId}&entityId=$row.get(3).getValue()&toRLabel=${entityId}' ,'remind',
    'toolbar=no,scrollbars=yes,resizable=yes,top=100,left=100,width=744,height=700'); " >查看</a> 
					#if($updateFlag == 1) 
						<a href="#" onclick= "window.open('/app/deviceErrorData/preEditEntity.ac?entityName='+ encodeURI('故障信息') +'&entityId=$row.get(3).getValue()&toRMetaId=${metaId}&toRMetaName=${entityName}&toREntityId=${entityId}&toRLabel=${entityId}' ,'remind',
    'toolbar=no,scrollbars=yes,resizable=yes,top=100,left=100,width=744,height=700'); "
												> 编辑</a>
					#end
					#if($updateFlag == 1) 
						<a href="#" onclick="delRec(8,'$row.get(3).getValue()')" >删除</a>
					#end
					</td>
          			#foreach($cell in $row)
						#if($velocityCount > 4) 
		              	<td>$cell.value</td>
						#end
          			#end
          			<td>$row.get(0)</td>
          			<td>$row.get(1)</td>
          			</tr>
				    #end
						
					</tr>

				</tbody></table>
				</div>
			<div class="select">
				<input type="hidden" name="trackPageInfo.currentPage" id="currentPageError" value="${trackPageInfo.currentPage}"/>
				#set($pre_page = $trackPageInfo.currentPage - 1)
				#set($next_page = $trackPageInfo.currentPage + 1)
				第<b>$trackPageInfo.currentPage</b>页,共<b>$trackPageInfo.totalPages</b>页
				#if($trackPageInfo.totalPages > 1)
             		#if($trackPageInfo.currentPage>1)
              			<a href="#" onclick="return go_page(1);">首页</a>
        				<a href="#" onclick="return go_page($pre_page);">上页</a>
        			#else
              			<a href="javascript:viod(0)" >首页</a>
        				<a href="javascript:viod(0)" >上页</a>
             		#end
             		#if($trackPageInfo.currentPage < $trackPageInfo.totalPages)
             			<a href="#" onclick="return go_page($next_page);">下页</a>
        				<a href="#" onclick="return go_page($trackPageInfo.totalPages);">尾页</a>
        			#else
             			<a href="javascript:viod(0)" >下页</a>
        				<a href="javascript:viod(0)" >尾页</a>
    				#end
    			#else
             		<a href="javascript:viod(0)" >首页</a>
       				<a href="javascript:viod(0)" >上页</a>
            		<a href="javascript:viod(0)" >下页</a>
       				<a href="javascript:viod(0)" >尾页</a>
    			#end
			</div>
					
			</div>

	#end
</form>
</div>
</body>
</html>
<script type='text/javascript' >
	$(document).ready(function() { 
		initAllSelect();
		//$('#timeErrorBegin').datepicker({});	
		//$('#timeErrorEnd').datepicker({});	
		$('#timeErrorBegin').datetimepicker(
				{ 
				     showSecond: true, 
				     timeFormat: 'hh:mm:ss' 
				});	
		$('#timeErrorEnd').datetimepicker(
				{ 
		     showSecond: true, 
		     timeFormat: 'hh:mm:ss' 
			});	
		//$('#timeErrorEnd').datepicker('refresh');
		//$('.hasDatepicker').last().datepicker('refresh');
	});
	
	function queryDeviceWorkData() {
		updateRelationListForm('errorRelationForm','errorMainRelation','/app/deviceErrorData/trackEntity.ac');
	}
	
	 function go_page(pageidx){
		  $('#currentPageError').val(pageidx);
			updateRelationListForm('errorRelationForm','errorMainRelation','/app/deviceErrorData/trackEntity.ac');
		  return false;
		}
	 
</script>

